Yarn 在进行安装的时候，不会安装依赖中的 `peerDependencies` 和 `devDependencies` 字段中的依赖，如果依赖使用者没有安装 `peerDependencies` 中的依赖，只会对其进行警告，而使用者可能会直接报错。



问题现状：

1. 应用安装了 **依赖 A**，安装完之后启动，一直报错，说缺少了 **依赖B** ，而这个 **依赖B** 实际是在 **依赖 A** 中被用到，应用中本身是没有被使用到的，但是未被安装，从而导致编译的时候报错。

   问题分析：**依赖B** 没有将其依赖正确的放在 `dependencies` 中，而是放在了 `peerDependencies` 或者 `devDependencies`，而应用没有在 package.json 中安装声明这些包，就导致安装的时候不会安装这些依赖，并且 **依赖 B** 没有把这些依赖打包进去，从而导致编译报错。

   方法一：应用的 package.json 配置安装 **依赖B** 。

   方法二：**依赖 A** 没有把  **依赖B**  打包进去，而且  **依赖A**  的使用者也没有用到，那么  **依赖A** 应该把  **依赖B**  声明在 `dependencies` 字段中，应用安装的时候自动进行安装。

2. 应用安装了 **依赖 A** 和 **依赖B**，同时 **依赖 A** 也依赖了 **依赖 B**，某天 **依赖B** 进行了升级调整，应用升级了 **依赖B**，对应用进行打包的时候发现打包产物中仍然有旧版本的 **依赖B**，因为 **依赖 A** 没有升级依赖的  **依赖 B** ，导致不同版本的  **依赖 B**  被打包进去。



总结，在进行开发基础库的时候， `dependencies` 、`peerDependencies` 、 `devDependencies` 三个包需要合理配置，否则可能会导致使用者因找不到依赖包而直接报错。

1. 对于确认使用者一定会用到的依赖，比如开发 react 组件库，那么使用者就一定会用到 react，那么此时基础库可以把 react 放到 `peerDependencies` 中，并且设定好版本范围。使用者在安装依赖的时候，基础库不会安装 react，交给使用者安装。
2. 对于不确定使用者一定会用到的依赖，并且不会被打包进去，那么应该要放在 `dependencies` 属性中。不能放在 `peerDependencies` 、 `devDependencies` 中，否则可能会导致使用者找不到依赖报错的问题。
3. 如果依赖已经放到了 `peerDependencies` 中，那么就不要再在 `dependencies` 中配置一份了，应该把其放在  `devDependencies` 中。