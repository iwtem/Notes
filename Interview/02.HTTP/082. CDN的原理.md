## CDN 的工作原理

CDN 全称 Content Delivery Network，即内容分发网络。其基本思路是尽可能避开互联网上有可能影响数据传输速度和稳定性的瓶颈和环节，使内容传输的更快、更稳定。

CDN 的**工作原理** 就是将源站的资源缓存CDN各个节点上，当请求命中了某个节点的资源缓存时，立即返回客户端，避免每个请求的资源都通过源站获取，避免网络拥塞、缓解源站压力，保证用户访问资源的速度和体验。

![CDN](./images/CDN.png)

**完整的CDN请求**

![cdn-request](./images/cdn-request.png)

1、用户访问图片内容，先经过本地DNS 解析，如果 LDNS 命中，直接返回给用户。

2、LDNS MISS，转发授权DNS 查询

3、返回域名 CNAME picwebws.pstatp.com.wsglb0.com. 对应IP地址(实际就是DNS调度系统的ip地址)

4、域名解析请求发送至DNS调度系统，DNS调度系统为请求分配最佳节点IP地址。

5、返回的解析IP地址

6、用户向缓存服务器发起请求，缓存服务器响应用户请求，将用户所需内容传送到用户终端。